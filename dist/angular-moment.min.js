//!  Angular Moment.js v0.2.8
//!  https://github.com/shaungrady/angular-momentjs
//!  (c) 2014 Shaun Grady
//!  License: MIT
"use strict";angular.module("moment",[]),angular.module("moment").constant("indexOf",function(t,e){if(t.indexOf)return t.indexOf(e);for(var a=0;a<t.length;a++)if(e===t[a])return a;return-1}).constant("getOffset",function(t){if(t){var e,a,n,o,i,r,m,l,d,s,u,f=document,c=window,p=f.body,$=f.documentElement,h=f.createElement("div");return h.style.paddingLeft=h.style.width="1px",p.appendChild(h),e=2==h.offsetWidth,p.removeChild(h),h=t.getBoundingClientRect(),a=$.clientTop||p.clientTop||0,n=$.clientLeft||p.clientLeft||0,o=c.pageYOffset||e&&$.scrollTop||p.scrollTop,i=c.pageXOffset||e&&$.scrollLeft||p.scrollLeft,s=o-a,u=i-n,r=h.top+s,d=h.left+u,l=h.bottom+s,m=h.right+u,{top:r,left:d,bottom:l,right:m}}}),angular.module("moment").provider("$moment",function(){function t(t){return t=t||"",t.match(/l/i)?moment().lang()._longDateFormat[t]||t:t}var e={$$pickerTemplates:{},$strictView:!0,$strictModel:!0,$defaultViewFormat:"L",$defaultModelFormat:moment.defaultFormat,$parseFormat:t};this.defaultViewFormat=function(t){return angular.isString(t)&&(e.$defaultViewFormat=t),this},this.defaultModelFormat=function(t){return angular.isString(t)&&(e.$defaultModelFormat=t),this},this.strictView=function(t){return"boolean"==typeof t&&(e.$strictView=t),this},this.strictModel=function(t){return"boolean"==typeof t&&(e.$strictModel=t),this},this.definePickerTemplate=function(t){return angular.isObject(t)&&t.name&&t.url&&(e.$$pickerTemplates[t.name]=t.url),this},this.$get=function(){if(angular.isDefined(moment.$strictView))return moment;try{Object.defineProperty(moment,"$strictView",{value:e.$strictView}),Object.defineProperty(moment,"$strictModel",{value:e.$strictModel}),Object.defineProperty(moment,"$defaultViewFormat",{value:e.$defaultViewFormat}),Object.defineProperty(moment,"$defaultModelFormat",{value:e.$defaultModelFormat}),Object.defineProperty(moment,"$parseFormat",{value:e.$parseFormat}),Object.defineProperty(moment,"$$pickerTemplates",{value:angular.copy(e.$$pickerTemplates)})}catch(t){angular.extend(moment,e)}return moment}}),angular.module("moment").filter("momentFormat",["$moment",function(t){return function(e,a){var n,o,i,r=t.$defaultViewFormat;return angular.isDefined(e)?(angular.isString(a)?r=a:angular.isArray(a)&&(i=a[0],r=a[1]||r,o=a[2]),n=t(e,i,o),n.isValid()?n.format(r):!angular.isDefined(i)&&(n=t(e,t.$defaultModelFormat,t.strictModel),n.isValid())?n.format(r):e):e}}]),angular.module("moment").directive("input",["$moment","$timeout","indexOf",function(t,e,a){var n=["millisecond","second","minute","hour","day","month","year"],o=t.$strictView,i=t.$strictModel;return{priority:10,restrict:"E",require:"?ngModel",compile:function(r,m){return"date"!==m.type&&"moment"!==m.type?angular.noop:function(r,m,l,d){if(d){var s,u,f,c=t.$defaultViewFormat,p=t.$defaultModelFormat,$=!1,h={min:{attr:null,view:null,model:null},max:{attr:null,view:null,model:null}},v=function(e){m.attr("placeholder",t.$parseFormat(e))},w=function(){var t=!d.$isEmpty(d.$modelValue),e=!d.$isEmpty(d.$viewValue);t?M():e&&y()},y=function(){d.$isEmpty(d.$viewValue)||d.$setViewValue(d.$viewValue)},M=function(){var t=d.$modelValue;d.$isEmpty(t)||e(function(){r.$apply(function(){r[l.ngModel]=t+" "}),r.$apply(function(){r[l.ngModel]=t})},0,!1)},g=function(e){h[e].attr&&h[e].attr.isValid()?(h[e].view=t(h[e].attr.format(c),c),h[e].model=t(h[e].attr.format(p),p)):h[e].attr=h[e].view=h[e].model=null},k=function(e,a){var n,r,m,u,f,$;return"view"==e?(u=c,f=p,$=o):(u=p,f=c,$=i),n=t(a,u,$),r=n.isValid(),m=d.$isEmpty(a),s=m?t(null):n.clone(),m||r?(d.$setValidity("date",!0),l.min&&(!m&&r&&h.min.attr&&n.isBefore(h.min[e])?d.$setValidity("min",!1):d.$setValidity("min",!0)),l.max&&(!m&&r&&h.max.attr&&n.isAfter(h.max[e])?d.$setValidity("max",!1):d.$setValidity("max",!0)),d.$error.min||d.$error.max?void 0:m?a:n.format(f)):(d.$setValidity("date",!1),l.min&&d.$setValidity("min",!0),void(l.max&&d.$setValidity("max",!0)))};if(d.$parsers.push(angular.bind(void 0,k,"view")),d.$formatters.push(angular.bind(void 0,k,"model")),!l.format||l.viewFormat&&l.modelFormat||(c=r.$eval(l.format)||c,p=r.$eval(l.format)||p,r.$watch(l.format,function(t){c=t,p=t,v(t),g("min"),g("max"),y()})),l.viewFormat&&(c=r.$eval(l.viewFormat)||c,r.$watch(l.viewFormat,function(e){e=e||t.$defaultViewFormat,e!==c&&(c=e,v(e),g("min"),g("max"),M())})),l.modelFormat&&(p=r.$eval(l.modelFormat)||p,r.$watch(l.modelFormat,function(e){e=e||t.$defaultModelFormat,e!==p&&(p=e,g("min"),g("max"),y())})),v(c),l.min){var x=function(e){var a;a=angular.isArray(e)&&2==e.length?t(e[0],e[1]):e&&angular.isString(e)?"today"==e?t():t(e,t.$defaultModelFormat):null,(!a^!h.min.attr||a&&h.min.attr&&a.format("X")!==h.min.attr.format("X"))&&(h.min.attr=a,g("min"),w())};x(r.$eval(l.min)),r.$watch(l.min,x,!0)}if(l.max){var F=function(e){var a;a=angular.isArray(e)&&2==e.length?t(e[0],e[1]):e&&angular.isString(e)?"today"==e?t():t(e,t.$defaultModelFormat):null,(!a^!h.max.attr||a&&h.max.attr&&a.format("X")!==h.max.attr.format("X"))&&(h.max.attr=a,g("max"),w())};F(r.$eval(l.max)),r.$watch(l.max,F,!0)}u="day",f=1,l.step&&r.$watch(l.step,function(t){if(t&&angular.isString(t)){var e=t.match(/(\d+)\s(\w+)/);e?(u=e[2],f=parseInt(e[1],10)):(u="day",f=1)}});var V=function(e,o){if(!e.type&&o&&o.type&&(angular.extend(e,o),$=!0),$&&("keydown"!=e.type||/38|40/.test(e.which))){e.preventDefault();var i,m,l,p,v,w=d.$isEmpty(d.$viewValue),y=w?t():t(s.format(c),c,!0);y.isValid()&&("keydown"==e.type?m=/38/.test(e.which):(i=e.originalEvent?e.originalEvent.wheelDelta:e.wheelDelta,m=i/120>0),l=e.shiftKey?n[a(n,u.replace(/s$/,""))+1]||u:u,w&&h.min.attr?p=h.min.view.clone():m?w&&!h.min.attr?p=y.max(h.max.attr?h.max.view:void 0):h.min.attr&&y.isBefore(h.min.view)?p=h.min.view.clone():h.max.attr&&!y.isAfter(h.max.view)?p=y.add(l,f).max(h.max.view):h.max.attr||(p=y.add(l,f)):w&&!h.max.attr?p=y.min(h.min.attr?h.min.view:void 0):h.max.attr&&y.isAfter(h.max.view)?p=h.max.view.clone():h.min.attr&&!y.isBefore(h.min.view)?p=y.subtract(l,f).min(h.min.view):h.min.attr||(p=y.subtract(l,f)),v=(p||y).format(c),r.$apply(function(){d.$setViewValue(v),d.$render()}))}};m.on("mousewheel keydown",V),m.on("focus",function(){$=!0}),m.on("blur",function(){$=!1})}}}}}]),angular.module("moment").directive("momentPicker",["$moment","$log","indexOf",function(t,e){{var a=t().startOf("week").format("d");t().endOf("week").format("d")}return{restrict:"A",templateUrl:function(a,n){var o=n.template||"default",i=t.$$pickerTemplates[o];return i?i:void e.error("Error: [momentDatepicker] Picker template for '"+o+"' is undefined. Templates must be defined with '$momentProvider.definePickerTemplate'.")},scope:{dateModel:"=momentPicker",format:"=?",modelFormat:"=?",min:"=?",max:"=?",ngShow:"=?"},link:function(e,n,o){function i(){e.today=t(),e.lastMonthMoments=[],e.thisMonthMoments=[],e.nextMonthMoments=[],e.monthsThisYearMoments=[];for(var n=e.displayMoment.clone().startOf("month"),o=n.clone(),i=e.displayMoment.clone().endOf("month"),r=e.displayMoment.format("M"),m=e.displayMoment.format("YYYY");n.format("d")!==a;)e.lastMonthMoments.unshift(n.subtract(1,"day").clone());for(;o.format("M")===r;)e.thisMonthMoments.push(o.clone()),o.add(1,"day");for(;e.lastMonthMoments.length+e.thisMonthMoments.length+e.nextMonthMoments.length<42;)e.nextMonthMoments.push(i.add(1,"day").clone());for(;e.monthsThisYearMoments.length<12;)e.monthsThisYearMoments.push(moment({year:m,month:e.monthsThisYearMoments.length}))}var r=t.$defaultModelFormat,m={};e.hasNgShowAttr=!!o.ngShow,o.ngShow||(e.ngShow=!0),e.displayMoment=t(),e.weekMoments=[];for(var l=7;l--;)e.weekMoments.unshift(t().startOf("week").add(l,"day"));var d=function(a){angular.equals(r,a)||(r=a||t.$defaultModelFormat,u(e.dateModel))};o.format&&!o.modelFormat?(r=e.format||t.$defaultModelFormat,e.$watch("format",d)):o.modelFormat&&(r=e.modelFormat||t.$defaultModelFormat,e.$watch("modelFormat",d));var s=function(e,a){var n;n=angular.isArray(a)&&2==a.length?t(a[0],a[1],!0):a&&angular.isString(a)?"today"==a?t():t(a,t.$defaultModelFormat,t.$strictModel):t(null),m[e]=n.isValid()?n:null};o.min&&e.$watch("min",function(t){s("min",t)},!0),o.max&&e.$watch("max",function(t){s("max",t)},!0),e.getClasses=function(t,a){var n=/0|6/.test(t.isoWeekday()),o=!n,i={weekend:n,weekday:o};return i[t.format("MMM ddd").toLowerCase()]=!0,a?(angular.forEach(a.split(" "),function(a){switch(a){case"today":i[a]=t.isSame(e.today,"day");break;case"this-week":i[a]=t.isSame(e.today,"week");break;case"this-month":i[a]=t.isSame(e.today,"month");break;case"this-year":i[a]=t.isSame(e.today,"year");break;case"picked-day":i[a]=t.isSame(e.dateMoment,"day");break;case"picked-week":i[a]=t.isSame(e.dateMoment,"week");break;case"picked-month":i[a]=t.isSame(e.dateMoment,"month");break;case"picked-year":i[a]=t.isSame(e.dateMoment,"year");break;case"invalid":if(!m.min&&!m.max)break;m.min&&t.isBefore(m.min,"day")?i.invalid=!0:m.max&&t.isBefore(m.max,"day")&&(i.invalid=!0)}}),i):void 0},e.setDateTo=function(t){m.min&&t.isBefore(m.min)||m.max&&t.isAfter(m.max)||(e.dateModel=t.format(r))};var u=function(a){var n=t(a,r,t.$strictModel);a&&n.isValid()?(e.dateMoment=n.clone(),e.displayMoment=n.clone()):(e.dateMoment=t(""),e.displayMoment=t())};e.$watch("dateModel",u),e.$watch(function(){return e.displayMoment.format("M/YYYY")},function(){i()})}}}]).directive("picker",["$moment","$compile","getOffset",function(t,e,a){var n='style="position:absolute" class="input-picker"',o="format modelFormat min max".split(" "),i=function(t){return t.replace(/[a-z][A-Z]/g,function(t){return t[0]+"-"+t[1]}).toLowerCase()};return{restrict:"A",require:"?ngModel",link:function(t,r,m,l){if(l&&"moment"===m.type){var d=[n];m.picker&&d.push("template="+m.picker),angular.forEach(o,function(t){m[t]&&d.push(i(t)+'="'+m[t]+'"')}),t.$momentPicker||(t.$momentPicker={}),t.$momentPicker[m.ngModel]=!1,d.push("ng-show=\"$momentPicker['"+m.ngModel+"']\"");var s=e('<div moment-picker="'+m.ngModel+'" '+d.join(" ")+"></div>")(t);angular.element(document.body).append(s),s.on("mousedown",function(t){t.preventDefault()}),r.on("focus click",function(){var e=a(r[0]);s.css({left:e.left+"px",top:e.bottom+"px"}),t.$apply(function(t){t.$momentPicker[m.ngModel]=!0})}),r.on("blur keydown",function(e){("keydown"!=e.type||27===e.which)&&t.$apply(function(t){t.$momentPicker[m.ngModel]=!1})}),t.$on("$destroy",function(){s.off().remove()})}}}}]);