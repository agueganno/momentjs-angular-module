//!  Angular Moment.js v0.3.1
//!  https://github.com/shaungrady/angular-momentjs
//!  (c) 2014 Shaun Grady
//!  License: MIT
"use strict";angular.module("moment",[]),angular.module("moment").constant("indexOf",function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}).constant("getOffset",function(t){if(t){var e,n,a,o,i,r,m,l,s,u,d,c=document,f=window,p=c.body,M=c.documentElement,$=c.createElement("div");return $.style.paddingLeft=$.style.width="1px",p.appendChild($),e=2==$.offsetWidth,p.removeChild($),$=t.getBoundingClientRect(),n=M.clientTop||p.clientTop||0,a=M.clientLeft||p.clientLeft||0,o=f.pageYOffset||e&&M.scrollTop||p.scrollTop,i=f.pageXOffset||e&&M.scrollLeft||p.scrollLeft,u=o-n,d=i-a,r=$.top+u,s=$.left+d,l=$.bottom+u,m=$.right+d,{top:r,left:s,bottom:l,right:m}}}),angular.module("moment").provider("$moment",function(){function t(t){return t=t||"",t.match(/l/i)?moment().lang()._longDateFormat[t]||t:t}var e={$$pickerTemplates:{},$strictView:!0,$strictModel:!0,$defaultViewFormat:"L",$defaultModelFormat:moment.defaultFormat,$parseFormat:t};this.defaultViewFormat=function(t){return angular.isString(t)&&(e.$defaultViewFormat=t),this},this.defaultModelFormat=function(t){return angular.isString(t)&&(e.$defaultModelFormat=t),this},this.strictView=function(t){return"boolean"==typeof t&&(e.$strictView=t),this},this.strictModel=function(t){return"boolean"==typeof t&&(e.$strictModel=t),this},this.definePickerTemplate=function(t){return angular.isObject(t)&&t.name&&t.url&&(e.$$pickerTemplates[t.name]={url:t.url,unit:t.unit||"days"}),this},this.$get=function(){if(angular.isDefined(moment.$strictView))return moment;try{Object.defineProperty(moment,"$strictView",{value:e.$strictView}),Object.defineProperty(moment,"$strictModel",{value:e.$strictModel}),Object.defineProperty(moment,"$defaultViewFormat",{value:e.$defaultViewFormat}),Object.defineProperty(moment,"$defaultModelFormat",{value:e.$defaultModelFormat}),Object.defineProperty(moment,"$parseFormat",{value:e.$parseFormat}),Object.defineProperty(moment,"$$pickerTemplates",{value:angular.copy(e.$$pickerTemplates),writable:!0})}catch(t){angular.extend(moment,e)}return moment}}),angular.module("moment").filter("momentFormat",["$moment",function(t){return function(e,n){var a,o,i,r=t.$defaultViewFormat;return angular.isDefined(e)?(angular.isString(n)?r=n:angular.isArray(n)&&(i=n[0],r=n[1]||r,o=n[2]),a=t(e,i,o),a.isValid()?a.format(r):!angular.isDefined(i)&&(a=t(e,t.$defaultModelFormat,t.strictModel),a.isValid())?a.format(r):e):e}}]),angular.module("moment").directive("input",["$moment","$timeout","indexOf",function(t,e,n){var a=["millisecond","second","minute","hour","day","month","year"],o=t.$strictView,i=t.$strictModel;return{priority:10,restrict:"E",require:"?ngModel",compile:function(r,m){return"date"!==m.type&&"moment"!==m.type?angular.noop:function(r,m,l,s){if(s){var u,d,c,f=t.$defaultViewFormat,p=t.$defaultModelFormat,M=!1,$={min:{attr:null,view:null,model:null},max:{attr:null,view:null,model:null}},h=function(e){m.attr("placeholder",t.$parseFormat(e))},v=function(){var t=!s.$isEmpty(s.$modelValue),e=!s.$isEmpty(s.$viewValue);t?w():e&&y()},y=function(){s.$isEmpty(s.$viewValue)||s.$setViewValue(s.$viewValue)},w=function(){var t=s.$modelValue;s.$isEmpty(t)||e(function(){r.$apply(function(){r[l.ngModel]=t+" "}),r.$apply(function(){r[l.ngModel]=t})},0,!1)},g=function(e){$[e].attr&&$[e].attr.isValid()?($[e].view=t($[e].attr.format(f),f),$[e].model=t($[e].attr.format(p),p)):$[e].attr=$[e].view=$[e].model=null},x=function(e,n){var a,r,m,d,c,M;return"view"==e?(d=f,c=p,M=o):(d=p,c=f,M=i),a=t(n,d,M),r=a.isValid(),m=s.$isEmpty(n),u=m?t(null):a.clone(),m||r?(s.$setValidity("date",!0),l.min&&(!m&&r&&$.min.attr&&a.isBefore($.min[e])?s.$setValidity("min",!1):s.$setValidity("min",!0)),l.max&&(!m&&r&&$.max.attr&&a.isAfter($.max[e])?s.$setValidity("max",!1):s.$setValidity("max",!0)),s.$error.min||s.$error.max?void 0:m?n:a.format(c)):(s.$setValidity("date",!1),l.min&&s.$setValidity("min",!0),void(l.max&&s.$setValidity("max",!0)))};if(s.$parsers.push(angular.bind(void 0,x,"view")),s.$formatters.push(angular.bind(void 0,x,"model")),!l.format||l.viewFormat&&l.modelFormat||(f=r.$eval(l.format)||f,p=r.$eval(l.format)||p,r.$watch(l.format,function(t){f=t,p=t,h(t),g("min"),g("max"),y()})),l.viewFormat&&(f=r.$eval(l.viewFormat)||f,r.$watch(l.viewFormat,function(e){e=e||t.$defaultViewFormat,e!==f&&(f=e,h(e),g("min"),g("max"),w())})),l.modelFormat&&(p=r.$eval(l.modelFormat)||p,r.$watch(l.modelFormat,function(e){e=e||t.$defaultModelFormat,e!==p&&(p=e,g("min"),g("max"),y())})),h(f),l.min){var k=function(e){var n;n=angular.isArray(e)&&2==e.length?t(e[0],e[1]):e&&angular.isString(e)?"today"==e?t():t(e,t.$defaultModelFormat):null,(!n^!$.min.attr||n&&$.min.attr&&n.format("X")!==$.min.attr.format("X"))&&($.min.attr=n,g("min"),v())};k(r.$eval(l.min)),r.$watch(l.min,k,!0)}if(l.max){var V=function(e){var n;n=angular.isArray(e)&&2==e.length?t(e[0],e[1]):e&&angular.isString(e)?"today"==e?t():t(e,t.$defaultModelFormat):null,(!n^!$.max.attr||n&&$.max.attr&&n.format("X")!==$.max.attr.format("X"))&&($.max.attr=n,g("max"),v())};V(r.$eval(l.max)),r.$watch(l.max,V,!0)}d="day",c=1,l.step&&r.$watch(l.step,function(t){if(t&&angular.isString(t)){var e=t.match(/(\d+)\s(\w+)/);e?(d=e[2],c=parseInt(e[1],10)):(d="day",c=1)}});var F=function(e,o){if(!e.type&&o&&o.type&&(angular.extend(e,o),M=!0),M&&("keydown"!=e.type||/38|40/.test(e.which))){e.preventDefault();var i,m,l,p,h,v=s.$isEmpty(s.$viewValue),y=v?t():t(u.format(f),f,!0);y.isValid()&&("keydown"==e.type?m=/38/.test(e.which):(i=e.originalEvent?e.originalEvent.wheelDelta:e.wheelDelta,m=i/120>0),l=e.shiftKey?a[n(a,d.replace(/s$/,""))+1]||d:d,v&&$.min.attr?p=$.min.view.clone():m?v&&!$.min.attr?p=y.max($.max.attr?$.max.view:void 0):$.min.attr&&y.isBefore($.min.view)?p=$.min.view.clone():$.max.attr&&!y.isAfter($.max.view)?p=y.add(l,c).max($.max.view):$.max.attr||(p=y.add(l,c)):v&&!$.max.attr?p=y.min($.min.attr?$.min.view:void 0):$.max.attr&&y.isAfter($.max.view)?p=$.max.view.clone():$.min.attr&&!y.isBefore($.min.view)?p=y.subtract(l,c).min($.min.view):$.min.attr||(p=y.subtract(l,c)),h=(p||y).format(f),r.$apply(function(){s.$setViewValue(h),s.$render()}))}};m.on("mousewheel keydown",F),m.on("focus",function(){M=!0}),m.on("blur",function(){M=!1})}}}}}]),angular.module("moment").directive("momentPicker",["$moment","$log","indexOf",function(t,e){var n=t().startOf("week").format("d"),a=(t().endOf("week").format("d"),function(e){return t.$$pickerTemplates[e||"default"]});return{restrict:"A",templateUrl:function(t,n){var o=a(n.template);return o?o.url:void e.error("Error: [momentDatepicker] Picker template '"+n.template+"' is undefined. Templates must be defined with '$momentProvider.definePickerTemplate'.")},scope:{dateModel:"=momentPicker",format:"=?",modelFormat:"=?",min:"=?",max:"=?",ngShow:"=?"},controller:["$scope","$element","$attrs","$parse","$animate","$moment","indexOf",function(t,e,o,i,r,m){function l(){t.today=m(),t.lastMonthMoments=[],t.thisMonthMoments=[],t.nextMonthMoments=[],t.monthsThisYearMoments=[],u.setDisplayMoment(m()),s(),t.weekMoments=[];for(var e=7;e--;)t.weekMoments.unshift(m().startOf("week").add(e,"day"))}function s(){var e=u.displayMoment.clone().startOf("month"),a=e.clone(),o=u.displayMoment.clone().endOf("month"),i=u.displayMoment.format("M"),r=u.displayMoment.format("YYYY");if(!t.thisMonthMoments.length||!a.isSame(t.thisMonthMoments[0])){for(t.today=m(),t.lastMonthMoments=[],t.thisMonthMoments=[],t.nextMonthMoments=[],t.monthsThisYearMoments=[];e.format("d")!==n;)t.lastMonthMoments.unshift(e.subtract(1,"day").clone());for(;a.format("M")===i;)t.thisMonthMoments.push(a.clone()),a.add(1,"day");for(;t.lastMonthMoments.length+t.thisMonthMoments.length+t.nextMonthMoments.length<42;)t.nextMonthMoments.push(o.add(1,"day").clone());for(;t.monthsThisYearMoments.length<12;)t.monthsThisYearMoments.push(moment({year:r,month:t.monthsThisYearMoments.length}))}}var u=this;u.template=a(o.template),u.format=m.$defaultModelFormat,u.pickedMoment=Number.NaN,u.maxMoment=Number.NaN,u.minMoment=Number.NaN,u.visible=!0,u.hidden=!1,u.setVisibility=function(t){u.hidden=!t,u.visible=!!t,r[t?"removeClass":"addClass"](e,"ng-hide")},u.setPickedMoment=function(e,n){var a=m.apply(null,arguments),o=e&&a.isValid();return o?void(u.minMoment&&a.isBefore(u.minMoment,u.template.unit)||u.maxMoment&&a.isAfter(u.maxMoment,u.template.unit)||(u.minMoment&&(a=a.min(u.minMoment)),u.maxMoment&&(a=a.max(u.maxMoment)),a.isSame(u.pickedMoment)||(u.pickedMoment=a.clone(),t.pickedMoment=a.clone(),t.dateModel=a.format(n),u.setDisplayMoment(a)))):(u.pickedMoment=null,void(t.pickedMoment=null))},u.setDisplayMoment=function(e){var n=m.apply(null,arguments),a=e&&n.isValid(),o=u.pickedMoment?u.pickedMoment:m();u.displayMoment=a?n.clone():o.clone(),t.displayMoment=a?n.clone():o.clone(),s()},u.setMinMoment=function(t){var e=m.apply(null,arguments),n=t&&e.isValid();u.minMoment=n?e.clone():null},u.setMaxMoment=function(t){var e=m.apply(null,arguments),n=t&&e.isValid();u.maxMoment=n?e.clone():null},u.setFormat=function(e){angular.equals(u.format,e)||(u.format=e||m.$defaultModelFormat,u.setPickedMoment(t.dateModel,u.format,m.$strictModel))},t.$watch("dateModel",function(t){u.setPickedMoment(t,u.format,m.$strictModel)}),o.format&&!o.modelFormat?(u.format=t.format||m.$defaultModelFormat,t.$watch("format",u.setFormat)):o.modelFormat&&(u.format=t.modelFormat||m.$defaultModelFormat,t.$watch("modelFormat",u.setFormat)),o.min&&t.$watch("min",function(t){var e=angular.isArray(t);u.setMinMoment.apply(null,e?t:[t])},!0),o.max&&t.$watch("max",function(t){var e=angular.isArray(t);u.setMaxMoment.apply(null,e?t:[t])},!0),t.setPickerVisibility=u.setVisibility,t.setDisplayMoment=u.setDisplayMoment,t.setPickedMoment=u.setPickedMoment,l()}],require:"momentPicker",link:function(t,e,n,a){t.getClasses=function(e,n){var o=/6|7/.test(e.isoWeekday()),i=!o,r={weekend:o,weekday:i};return r[e.format("MMM ddd").toLowerCase()]=!0,n?(angular.forEach(n.split(" "),function(n){var o=n.split("-")[0],i=n.split("-")[1]||a.template.unit;t.pickedMoment&&"picked"==o?r[n]=e.isSame(t.pickedMoment,a.template.unit):"current"==o?r[n+" current"]=e.isSame(t.today,i):"invalid"==o&&(a.minMoment||a.maxMoment)&&(a.minMoment&&e.isBefore(a.minMoment,i)?r[n+" invalid"]=!0:a.maxMoment&&e.isAfter(a.maxMoment,i)&&(r[n+" invalid"]=!0))}),r):r}}}}]).directive("picker",["$moment","$compile","getOffset",function(t,e,n){var a='style="position:absolute" class="input-picker"',o="format modelFormat min max".split(" "),i=function(t){return t.replace(/[a-z][A-Z]/g,function(t){return t[0]+"-"+t[1]}).toLowerCase()};return{restrict:"A",require:["?ngModel"],link:function(t,r,m,l){function s(){f(),d=u.isolateScope(),c=u.controller("momentPicker"),c.setVisibility(!1),d.showClose=!0}if(l&&"moment"===m.type){var u,d,c,f,p=[a];m.picker&&p.push("template="+m.picker),angular.forEach(o,function(t){m[t]&&p.push(i(t)+'="'+m[t]+'"')}),u=e('<div moment-picker="'+m.ngModel+'" '+p.join(" ")+"></div>")(t),f=t.$watch(function(){u.controller("momentPicker")&&s()}),angular.element(document.body).append(u),u.on("mousedown",function(t){t.preventDefault()}),r.on("focus click",function(){var t=n(r[0]);u.css({left:t.left+"px",top:t.bottom+"px"}),c.setVisibility(!0)}),r.on("blur keydown",function(t){("keydown"!=t.type||27===t.which)&&c.setVisibility(!1)}),t.$on("$destroy",function(){u.off().remove()})}}}}]);